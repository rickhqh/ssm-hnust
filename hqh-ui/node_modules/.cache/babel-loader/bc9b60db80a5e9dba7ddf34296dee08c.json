{"ast":null,"code":"import { ref } from \"vue\";\nimport { ElTable } from \"element-plus\";\nimport { listUser, add, getById, update, deleteUser } from \"@/api/user\";\nimport { onMounted } from \"vue\";\nimport { Plus, EditPen, Delete, Search, Upload } from \"@element-plus/icons-vue\";\nimport { ElMessageBox, ElMessage } from \"element-plus\";\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const queryParam = ref({\n      size: 2,\n      page: 0,\n      userName: \"\",\n      nickName: \"\"\n    });\n    let userForm = ref({\n      userId: null,\n      userName: \"\",\n      nickName: \"\",\n      password: \"\",\n      confirmPassword: \"\"\n    });\n    let dialogVisible = ref(false);\n    const tableData = ref([]);\n    const total = ref(0);\n    let title = ref(\"新增用户\");\n\n    const getList = function () {\n      listUser(queryParam.value).then(res => {\n        tableData.value = res.data.content;\n        total.value = res.data.totalElements;\n        queryParam.value.size = res.data.size;\n      });\n    };\n\n    onMounted(() => {\n      getList();\n    });\n\n    const changePage = async function (current) {\n      queryParam.value.page = current - 1;\n      getList();\n    };\n\n    const onSubmit = function () {\n      getList();\n    };\n\n    const submitFrom = function () {\n      // 1、对比确认密码和密码\n      // 2、校验表单\n      // 3、提交ajax请求\n      delete userForm.value.confirmPassword; // 判断当前的userId是不是null，如果是null 就新增，反之修改\n\n      if (userForm.value.userId === null) {\n        add(userForm.value).then(res => {\n          console.log(res);\n          dialogVisible.value = false;\n        }); // 更新列表\n\n        getList();\n      } else {\n        update(userForm.value).then(res => {\n          if (res.status === 200) {\n            dialogVisible.value = false;\n          } // 更新列表\n\n\n          getList();\n        });\n      }\n    };\n\n    const handleEdit = function (index, row) {\n      getById(row.userId).then(res => {\n        userForm.value = res.data; // 打开修改窗口\n\n        title.value = \"修改用户\";\n        dialogVisible.value = true;\n      });\n    };\n\n    let create = function () {\n      // 清理数据\n      userForm.value = {\n        userId: null,\n        userName: \"\",\n        nickName: \"\",\n        password: \"\",\n        confirmPassword: \"\"\n      };\n      title.value = \"新增用户\";\n      dialogVisible.value = true;\n    };\n\n    const handleDelete = function (index, row) {\n      ElMessageBox.alert(\"您确定要删除此条信息吗？\", \"提示消息\", {\n        confirmButtonText: \"确定\",\n        callback: () => {\n          deleteUser(row.userId).then(res => {\n            if (res.status === 200) {\n              // 更新列表\n              getList();\n              ElMessage({\n                type: \"info\",\n                message: `删除成功!`\n              });\n            }\n          });\n        }\n      });\n    };\n\n    const __returned__ = {\n      queryParam,\n      userForm,\n      dialogVisible,\n      tableData,\n      total,\n      title,\n      getList,\n      changePage,\n      onSubmit,\n      submitFrom,\n      handleEdit,\n      create,\n      handleDelete,\n      ref,\n      ElTable,\n      listUser,\n      add,\n      getById,\n      update,\n      deleteUser,\n      onMounted,\n      Plus,\n      EditPen,\n      Delete,\n      Search,\n      Upload,\n      ElMessageBox,\n      ElMessage\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["ref","ElTable","listUser","add","getById","update","deleteUser","onMounted","Plus","EditPen","Delete","Search","Upload","ElMessageBox","ElMessage","queryParam","size","page","userName","nickName","userForm","userId","password","confirmPassword","dialogVisible","tableData","total","title","getList","value","then","res","data","content","totalElements","changePage","current","onSubmit","submitFrom","console","log","status","handleEdit","index","row","create","handleDelete","alert","confirmButtonText","callback","type","message"],"sources":["C:/Users/贺启衡/Desktop/hqh/ssm/hqh-ui/src/components/login/index.vue"],"sourcesContent":["<template>\r\n  <!-- <el-button @click=\"resetDateFilter\">reset date filter</el-button>\r\n  <el-button @click=\"clearFilter\">reset all filters</el-button> -->\r\n\r\n  <el-form :inline=\"true\" :model=\"queryParam\" class=\"demo-form-inline\">\r\n    <el-form-item label=\"用户名:\">\r\n      <el-input v-model=\"queryParam.userName\" placeholder=\"用户名\"></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"昵称:\">\r\n      <el-input v-model=\"queryParam.nickName\" placeholder=\"昵称\"></el-input>\r\n    </el-form-item>\r\n\r\n    <el-form-item>\r\n      <el-button type=\"primary\" @click=\"onSubmit\">查询</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n\r\n  <div class=\"flex\">\r\n    <el-button\r\n      type=\"primary\"\r\n      :icon=\"Plus\"\r\n      v-hasRole=\"['admin']\"\r\n      @click=\"create\"\r\n    ></el-button>\r\n    <el-button type=\"primary\" :icon=\"EditPen\" @click=\"update\"></el-button>\r\n    <el-button type=\"primary\" :icon=\"Delete\"></el-button>\r\n    <el-button type=\"primary\" :icon=\"Search\">Search</el-button>\r\n    <el-button type=\"primary\">\r\n      Upload<el-icon class=\"el-icon--right\"><Upload /></el-icon>\r\n    </el-button>\r\n  </div>\r\n\r\n  <el-table\r\n    ref=\"tableRef\"\r\n    row-key=\"userName\"\r\n    :data=\"tableData\"\r\n    style=\"width: 100%\"\r\n  >\r\n    <el-table-column prop=\"userName\" label=\"用户名\" width=\"180\" />\r\n    <el-table-column prop=\"nickName\" label=\"昵称\" width=\"180\" />\r\n    <el-table-column prop=\"email\" label=\"邮箱\" />\r\n    <el-table-column label=\"操作\">\r\n      <template #default=\"scope\">\r\n        <el-button size=\"small\" @click=\"handleEdit(scope.$index, scope.row)\"\r\n          >编辑</el-button\r\n        >\r\n        <el-button\r\n          size=\"small\"\r\n          type=\"danger\"\r\n          @click=\"handleDelete(scope.$index, scope.row)\"\r\n          >删除</el-button\r\n        >\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n  <el-pagination\r\n    background\r\n    layout=\" prev, pager, next\"\r\n    @current-change=\"changePage\"\r\n    :total=\"total\"\r\n    :page-sizes=\"[2, 5, 10, 15]\"\r\n    :page-size=\"queryParam.size\"\r\n  >\r\n  </el-pagination>\r\n\r\n  <!--新增和修改用户-->\r\n  <el-dialog v-model=\"dialogVisible\" :title=\"title\" width=\"30%\">\r\n    <el-form ref=\"userFormRef\" :model=\"userForm\" label-width=\"120px\">\r\n      <el-form-item label=\"用户名\">\r\n        <el-input v-model=\"userForm.userName\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"昵称\">\r\n        <el-input v-model=\"userForm.nickName\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"密码\" v-if=\"userForm.userId === null\">\r\n        <el-input v-model=\"userForm.password\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"确认密码\" v-if=\"userForm.userId === null\">\r\n        <el-input v-model=\"userForm.confirmPassword\"></el-input>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitFrom\">提交</el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\nimport { ElTable } from \"element-plus\";\r\nimport { listUser, add, getById, update, deleteUser } from \"@/api/user\";\r\nimport { onMounted } from \"vue\";\r\nimport { Plus, EditPen, Delete, Search, Upload } from \"@element-plus/icons-vue\";\r\nimport { ElMessageBox, ElMessage } from \"element-plus\";\r\nconst queryParam = ref({\r\n  size: 2,\r\n  page: 0,\r\n  userName: \"\",\r\n  nickName: \"\",\r\n});\r\n\r\nlet userForm = ref({\r\n  userId: null,\r\n  userName: \"\",\r\n  nickName: \"\",\r\n  password: \"\",\r\n  confirmPassword: \"\",\r\n});\r\n\r\nlet dialogVisible = ref(false);\r\nconst tableData = ref([]);\r\nconst total = ref(0);\r\nlet title = ref(\"新增用户\");\r\n\r\nconst getList = function () {\r\n  listUser(queryParam.value).then((res) => {\r\n    tableData.value = res.data.content;\r\n    total.value = res.data.totalElements;\r\n    queryParam.value.size = res.data.size;\r\n  });\r\n};\r\n\r\nonMounted(() => {\r\n  getList();\r\n});\r\n\r\nconst changePage = async function (current) {\r\n  queryParam.value.page = current - 1;\r\n  getList();\r\n};\r\n\r\nconst onSubmit = function () {\r\n  getList();\r\n};\r\n\r\nconst submitFrom = function () {\r\n  // 1、对比确认密码和密码\r\n\r\n  // 2、校验表单\r\n\r\n  // 3、提交ajax请求\r\n  delete userForm.value.confirmPassword;\r\n  // 判断当前的userId是不是null，如果是null 就新增，反之修改\r\n  if (userForm.value.userId === null) {\r\n    add(userForm.value).then((res) => {\r\n      console.log(res);\r\n      dialogVisible.value = false;\r\n    });\r\n    // 更新列表\r\n    getList();\r\n  } else {\r\n    update(userForm.value).then((res) => {\r\n      if (res.status === 200) {\r\n        dialogVisible.value = false;\r\n      }\r\n      // 更新列表\r\n      getList();\r\n    });\r\n  }\r\n};\r\n\r\nconst handleEdit = function (index, row) {\r\n  getById(row.userId).then((res) => {\r\n    userForm.value = res.data;\r\n    // 打开修改窗口\r\n    title.value = \"修改用户\";\r\n    dialogVisible.value = true;\r\n  });\r\n};\r\n\r\nlet create = function () {\r\n  // 清理数据\r\n  userForm.value = {\r\n    userId: null,\r\n    userName: \"\",\r\n    nickName: \"\",\r\n    password: \"\",\r\n    confirmPassword: \"\",\r\n  };\r\n  title.value = \"新增用户\";\r\n  dialogVisible.value = true;\r\n};\r\n\r\nconst handleDelete = function (index, row) {\r\n  ElMessageBox.alert(\"您确定要删除此条信息吗？\", \"提示消息\", {\r\n    confirmButtonText: \"确定\",\r\n    callback: () => {\r\n      deleteUser(row.userId).then((res) => {\r\n        if (res.status === 200) {\r\n          // 更新列表\r\n          getList();\r\n\r\n          ElMessage({\r\n            type: \"info\",\r\n            message: `删除成功!`,\r\n          });\r\n        }\r\n      });\r\n    },\r\n  });\r\n};\r\n</script>\r\n\r\n\r\n<style>\r\n</style>"]},"metadata":{},"sourceType":"module"}